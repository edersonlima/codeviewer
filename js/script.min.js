$(function(){var b=ace.edit("editor1");b.setTheme("ace/theme/dracula");b.session.setMode("ace/mode/abap");b.renderer.setScrollMargin(10,10);b.setOptions({autoScrollEditorIntoView:true,enableMultiselect:true,fadeFoldWidgets:true,useSoftTabs:true,tabSize:2,enableBasicAutocompletion:true,enableSnippets:true,wrap:true,maxLines:30,minLines:2});var c=1;function d(){var f=$(".ace_editor").eq($(".ace_editor").length-1).attr("id");f=ace.edit(f).container;c++;var g=document.createElement("div");g.setAttribute("id","editor"+c);f.parentNode.insertBefore(g,f.nextSibling);b=ace.edit(g);b.renderer.setScrollMargin(10,10);b.setOptions({mode:$("#language option:selected").val(),theme:"ace/theme/dracula",autoScrollEditorIntoView:true,enableMultiselect:true,fadeFoldWidgets:true,useSoftTabs:true,tabSize:2,enableBasicAutocompletion:true,enableSnippets:true,wrap:true,maxLines:30,minLines:2});var e=document.createElement("div");e.innerHTML='<a href="#" data-editor="'+c+'" class="btn btn-danger btn-sm btn-remove" title="Remove this one!"><i class="fas fa-trash"></i></a>';b.container.appendChild(e);a()}function a(e){var f=b.container.getBoundingClientRect().top;e=e||10;if(f>60&&e<500){if(e>f-e-50){e=f-e-50}else{setTimeout(a,10,e+10)}window.scrollBy(0,e)}}window.add=d;window.scroll=a;$("#new").click(function(){if(confirm("Are you sure you want to start a new project? You may lost the unsaved data!")){location.reload()}});$("#import").click(function(){$("#file").trigger("click")});String.prototype.replaceAll=function(e,f){var g=this;return g.split(e).join(f)};$("#file").on("change",function(f){var g=$("#content");g.html("");function e(l){var k=1;JSZip.loadAsync(l).then(function(i){i.forEach(function(m,o){var p=l.name;p=p.replace(".zip","");p=p.split("-");var n="ace/mode/abap";if(p.length==2){$("#name").val(p[0]);n=p[1].replaceAll("_","/");$("#language").val(n)}Promise.all([i.file(o.name).async("text")]).then(function(q){var v=q[0];if(k==1){var u=document.getElementById("content");var t=document.createElement("div");t.setAttribute("id","editor"+k);u.appendChild(t);b=ace.edit(t);b.renderer.setScrollMargin(10,10);b.setOptions({mode:n,theme:"ace/theme/dracula",autoScrollEditorIntoView:true,enableMultiselect:true,fadeFoldWidgets:true,useSoftTabs:true,tabSize:2,enableBasicAutocompletion:true,enableSnippets:true,wrap:true,maxLines:30,minLines:2});b.setValue([v].join(""),-1)}else{var s=$(".ace_editor").eq($(".ace_editor").length-1).attr("id");s=ace.edit(s).container;var t=document.createElement("div");t.setAttribute("id","editor"+k);s.parentNode.insertBefore(t,s.nextSibling);b=ace.edit(t);b.renderer.setScrollMargin(10,10);b.setOptions({mode:n,theme:"ace/theme/dracula",autoScrollEditorIntoView:true,enableMultiselect:true,fadeFoldWidgets:true,useSoftTabs:true,tabSize:2,enableBasicAutocompletion:true,enableSnippets:true,wrap:true,maxLines:30,minLines:2});b.setValue([v].join(""),-1);var r=document.createElement("div");r.innerHTML='<a href="#" data-editor="'+k+'" class="btn btn-danger btn-sm btn-remove" title="Remove this one!"><i class="fas fa-trash"></i></a>';b.container.appendChild(r)}k++})})},function(i){console.log("Error reading "+l.name+": "+i.message)})}var j=f.target.files;for(var h=0;h<j.length;h++){e(j[h])}});$("#save").click(function(){var f=$(".ace_editor");var e=$("#name").val();var j=$("#language").val();var h=new JSZip();for(var g=0;g<f.length;g++){editorToSave=ace.edit(f.eq(g).attr("id"));h.file(f.eq(g).attr("id")+".txt",editorToSave.getValue());if(g==(f.length-1)){h.generateAsync({type:"blob"}).then(function(i){saveAs(i,e+"-"+j+".zip")})}}});$(document).on("click","a.btn-remove",function(){var e=$(this).data("editor");editorToRemove=ace.edit("editor"+e);editorToRemove.container.remove()});$("#language").change(function(){var h=$(this).val();var f=$(".ace_editor");for(var g=0;g<f.length;g++){var j=ace.edit("editor"+(g+1));j.session.setMode(h)}});$("body").on("keydown",function(f){if(f.keyCode==82&&f.ctrlKey||f.keyCode==116){if(!confirm("Are you sure you want to update this page? You may lost the unsaved data!")){if(f.preventDefault){f.preventDefault();f.stopPropagation()}}}})});